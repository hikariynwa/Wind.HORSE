<div class="relative h-screen">
  <!-- タイトル部分 -->
  <div class="absolute top-16 w-full flex justify-center mx-auto">
    <div class="text-3xl"><%= @location_name %>競馬場</div>
  </div>

  <!-- 競馬場コース画像と方位マークの挿入 -->
  <div class="absolute w-full flex justify-center mx-auto mt-40">
    <div class="relative mx-auto w-full max-w-xl">
      <%= image_tag @course_image, alt: "#{@location_name}競馬場コース", class: "max-w-xl h-auto" %>

      <!-- 方位マークの表示 -->
      <div class="absolute top-5 right-5">
        <%= image_tag 'direction.png', alt: "N", style: "transform: rotate(#{@course_rotation}); width: 50px;" %>
      </div>
    </div>
  </div>

  <!-- ボタン表示部分 -->
  <div class="absolute bottom-10 w-full flex justify-center mx-auto">
    <div>
      <button id="fetch-wind" class="text-2xl bg-green-600 p-3 text-white w-full text-center">風の情報を取得する</button>
      <div id="wind-result" class="mt-4 text-2xl text-blue-500 w-full text-center"></div>
    </div>
  </div>
</div>

<script>
  document.getElementById('fetch-wind').addEventListener('click', function() {
    const location = "<%= params[:location] %>"; // 検索結果から場所を取得

    fetch(`/winds/${location}`, {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
      }
    })
    .then(response => response.json())
    .then(data => {
      const resultElement = document.getElementById('wind-result');
      if (data.error) {
        resultElement.textContent = data.error;
      } else {
        resultElement.textContent = `風速: ${data.wind_speed} m/s, 風向: ${data.wind_direction}`;
      }
    })
    .catch(error => {
      console.error('Error fetching wind data:', error);
      document.getElementById('wind-result').textContent = '風の情報を取得できませんでした。';
    });
  });
</script>